"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1028],{1028:(w,m,c)=>{c.r(m),c.d(m,{LoginPageModule:()=>A});var p=c(9808),n=c(4182),r=c(8962),g=c(2589),v=c(655),h=c(520),o=c(6435),f=c(5739),L=c(3602),Z=c(2160);function T(i,a){1&i&&(o.TgZ(0,"div",14),o._uU(1," Email requerido "),o.qZA())}function S(i,a){1&i&&(o.TgZ(0,"div",14),o._uU(1," Email debe tener 5 caracteres minimo "),o.qZA())}function P(i,a){1&i&&(o.TgZ(0,"div",14),o._uU(1," El email debe tener un formato correcto. "),o.qZA())}function b(i,a){if(1&i&&(o.TgZ(0,"div"),o.YNc(1,T,2,0,"div",13),o.YNc(2,S,2,0,"div",13),o.YNc(3,P,2,0,"div",13),o.qZA()),2&i){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",e.email.errors.required),o.xp6(1),o.Q6J("ngIf",e.email.errors.minlength),o.xp6(1),o.Q6J("ngIf",(e.email.dirty||e.email.touched)&&e.email.invalid&&e.email.errors.pattern)}}function y(i,a){1&i&&(o.TgZ(0,"div",14),o._uU(1," Contrase\xf1a requerida "),o.qZA())}function I(i,a){1&i&&(o.TgZ(0,"div",14),o._uU(1," Contrase\xf1a debe tener 6 caracteres minimo "),o.qZA())}function _(i,a){if(1&i&&(o.TgZ(0,"div"),o.YNc(1,y,2,0,"div",13),o.YNc(2,I,2,0,"div",13),o.qZA()),2&i){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",e.password.errors.required),o.xp6(1),o.Q6J("ngIf",e.password.errors.minlength)}}const k=[{path:"",component:(()=>{class i{constructor(e,t,s,l,d,u){this.authSvc=e,this.router=t,this.interactionSvc=s,this.cookieService=l,this.http=d,this.formBuilder=u,this.httpOptions={headers:new h.WM({"Content-Type":"application/json"})},this.emailPattern=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,this.createForm()}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}createForm(){this.loginForm=this.formBuilder.group({email:["",[n.kI.required,n.kI.minLength(5),n.kI.pattern(this.emailPattern)]],password:["",[n.kI.required,n.kI.minLength(6)]]})}ngOnInit(){}onSubmit(){return(0,v.mG)(this,void 0,void 0,function*(){const e={email:this.loginForm.value.email,password:this.loginForm.value.password};try{yield this.interactionSvc.presentLoading();const s=yield this.authSvc.login(e.email,e.password);s?(this.authSvc.isMailVerified(s),this.cookieService.set("token",s.token),this.interactionSvc.loading.dismiss(),this.interactionSvc.presentToast("Ha ingresado con exito!!",3e3),this.router.navigate(["home"]),this.loginForm.reset()):(this.interactionSvc.loading.dismiss(),this.interactionSvc.presentToast("Login incorrecto. Revise sus datos",3e3),this.loginForm.reset())}catch(s){console.log("Error",s)}const t=Object.assign(Object.assign({},e),{returnSecureToken:!0});this.http.post("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyApr_5WOVSiBdmA-vSfCIs_3CjMfP4J2Rw",JSON.stringify(t),{observe:"response"}).subscribe(s=>{const l=s.body.idToken,d=s.body.localId,u=s.body.expiresIn;console.log(l),localStorage.setItem("token",l),localStorage.setItem("localId",d),localStorage.setItem("expiresIn",u),this.cookieService.set("token",l),sessionStorage.setItem("token",l),this.router.navigate(["home"])})})}onLoginGoogle(){return(0,v.mG)(this,void 0,void 0,function*(){try{const e=yield this.authSvc.loginGoogle();if(e){const t=this.authSvc.isMailVerified(e);this.interactionSvc.presentToast("Ha ingresado con exito!!",3e3),this.redirectUser(t)}}catch(e){console.log("Error",e),this.interactionSvc.presentToast("Login incorrecto. Revise sus datos",3e3)}})}redirectUser(e){this.router.navigate(e?["home"]:["verify-email"])}}return i.\u0275fac=function(e){return new(e||i)(o.Y36(f.e),o.Y36(g.F0),o.Y36(L.k),o.Y36(Z.N),o.Y36(h.eN),o.Y36(n.qu))},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-login"]],decls:41,vars:4,consts:[["color","secondary"],["button","","size","large","name","arrow-back-outline","routerLink","/home"],["slot","end"],[3,"formGroup","ngSubmit"],["type","text","formControlName","email"],[4,"ngIf"],["type","text","formControlName","password"],["type","submit","expand","block",3,"disabled","click"],[1,"ion-text-end"],["routerLink","/forgot-password"],[1,"center-span"],["type","submit","color","warning","expand","block",3,"click"],["routerLink","/registro"],["class","error",4,"ngIf"],[1,"error"]],template:function(e,t){1&e&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0),o._UZ(2,"ion-icon",1),o.TgZ(3,"ion-title",2),o._uU(4,"Login "),o.qZA()()(),o.TgZ(5,"ion-content")(6,"ion-card")(7,"form",3),o.NdJ("ngSubmit",function(){return t.onSubmit}),o.TgZ(8,"ion-card")(9,"div")(10,"label"),o._uU(11," Email "),o.qZA(),o._UZ(12,"ion-input",4),o.YNc(13,b,4,3,"div",5),o.qZA()(),o.TgZ(14,"div")(15,"label"),o._uU(16," Password "),o.qZA(),o._UZ(17,"ion-input",6),o.YNc(18,_,3,2,"div",5),o.qZA(),o.TgZ(19,"div")(20,"ion-col")(21,"ion-button",7),o.NdJ("click",function(){return t.onSubmit()}),o._uU(22,"Login"),o.qZA()()()()(),o.TgZ(23,"ion-row")(24,"ion-col")(25,"p",8)(26,"a",9),o._uU(27,"\xbfOlvidaste la contrase\xf1a?"),o.qZA()()()(),o.TgZ(28,"span",10),o._uU(29,"Or"),o.qZA(),o.TgZ(30,"ion-row")(31,"ion-col")(32,"ion-button",11),o.NdJ("click",function(){return t.onLoginGoogle()}),o._uU(33,"Login con Google "),o.qZA()()(),o.TgZ(34,"form")(35,"ion-grid")(36,"ion-row")(37,"ion-col")(38,"p",8)(39,"a",12),o._uU(40,"Crea una cuenta"),o.qZA()()()()()()()),2&e&&(o.xp6(7),o.Q6J("formGroup",t.loginForm),o.xp6(6),o.Q6J("ngIf",t.email.invalid&&(t.email.dirty||t.email.touched)),o.xp6(5),o.Q6J("ngIf",t.password.invalid&&(t.password.dirty||t.password.touched)),o.xp6(3),o.Q6J("disabled",!t.loginForm.valid))},directives:[r.Gu,r.sr,r.gu,r.YI,g.rH,r.wd,r.W2,r.PM,n._Y,n.JL,n.sg,r.pK,r.j9,n.JJ,n.u,p.O5,r.wI,r.YG,r.Nd,g.yS,n.F,r.jY],styles:[".center-span[_ngcontent-%COMP%]{display:block;text-align:center}#email[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;border:1px solid #00748b;margin-bottom:4%}#password[_ngcontent-%COMP%]{margin-top:4%}.error[_ngcontent-%COMP%]{color:red;margin-top:2px}"]}),i})()}];let x=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[[g.Bz.forChild(k)],g.Bz]}),i})(),A=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[[p.ez,n.u5,r.Pc,x,n.UX]]}),i})()}}]);