"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8264],{8264:(J,m,c)=>{c.r(m),c.d(m,{SetProductosPageModule:()=>I});var g=c(9808),u=c(4182),s=c(8962),_=c(2589),d=c(655),h=c(8210),o=c(6435),P=c(1343),v=c(2041),S=c(3963),Z=c(3602),x=c(5739);function b(n,a){if(1&n&&(o.TgZ(0,"ion-select-option",22),o._uU(1),o.qZA()),2&n){const e=a.$implicit;o.Q6J("value",e.nombre),o.xp6(1),o.Oqu(e.nombre)}}function C(n,a){if(1&n&&(o.TgZ(0,"ion-select-option",22),o._uU(1),o.qZA()),2&n){const e=a.$implicit;o.Q6J("value",e.nombre),o.xp6(1),o.Oqu(e.nombre)}}function T(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-buttons",7)(4,"ion-button",8),o.NdJ("click",function(){return o.CHM(e),o.oxw().enableNewProducto=!1}),o._UZ(5,"ion-icon",9),o.qZA(),o.TgZ(6,"ion-button",8),o.NdJ("click",function(){return o.CHM(e),o.oxw().guardarProducto()}),o._UZ(7,"ion-icon",10),o.qZA()()(),o.TgZ(8,"h3",5),o._uU(9,"Ingrese datos del producto"),o.qZA(),o.TgZ(10,"ion-item")(11,"ion-label",11),o._uU(12," Nombre: "),o.qZA(),o.TgZ(13,"ion-input",12),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().newProducto.nombre=t}),o.qZA()(),o.TgZ(14,"ion-item")(15,"ion-label",11),o._uU(16," Precio: "),o.qZA(),o.TgZ(17,"ion-input",13),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().newProducto.precio=t}),o.qZA()(),o.TgZ(18,"ion-item")(19,"ion-label",11),o._uU(20," Presentacion: "),o.qZA(),o.TgZ(21,"ion-input",12),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().newProducto.presentacion=t}),o.qZA()(),o.TgZ(22,"ion-item")(23,"ion-label"),o._uU(24,"Supermercado"),o.qZA(),o.TgZ(25,"ion-select",14),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().newProducto.supermercado=t}),o.YNc(26,b,2,2,"ion-select-option",15),o.qZA()(),o.TgZ(27,"ion-item")(28,"ion-label"),o._uU(29,"Secciones"),o.qZA(),o.TgZ(30,"ion-select",16),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().newProducto.seccion=t}),o.YNc(31,C,2,2,"ion-select-option",15),o.qZA()(),o.TgZ(32,"ion-item")(33,"ion-label",17),o._uU(34," Foto: "),o.qZA(),o.TgZ(35,"ion-buttons",7)(36,"ion-button")(37,"label",18),o._UZ(38,"ion-icon",19),o.qZA(),o.TgZ(39,"input",20),o.NdJ("change",function(t){return o.CHM(e),o.oxw().newImageUpload(t)}),o.qZA()()(),o.TgZ(40,"div")(41,"ion-label"),o._uU(42,"Previsualizacion"),o.qZA(),o._UZ(43,"img",21),o.qZA(),o._UZ(44,"img",21),o.qZA()()()}if(2&n){const e=o.oxw();o.xp6(13),o.Q6J("ngModel",e.newProducto.nombre),o.xp6(4),o.Q6J("ngModel",e.newProducto.precio),o.xp6(4),o.Q6J("ngModel",e.newProducto.presentacion),o.xp6(4),o.Q6J("ngModel",e.newProducto.supermercado),o.xp6(1),o.Q6J("ngForOf",e.supermercados),o.xp6(4),o.Q6J("ngModel",e.newProducto.seccion),o.xp6(1),o.Q6J("ngForOf",e.secciones),o.xp6(12),o.Q6J("src",e.newImage,o.LSH),o.xp6(1),o.Q6J("src",e.newProducto.foto,o.LSH)}}function M(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"ion-item")(1,"ion-label",17),o._uU(2),o.qZA(),o.TgZ(3,"ion-buttons",7)(4,"ion-button",8),o.NdJ("click",function(){const r=o.CHM(e).$implicit,l=o.oxw();return l.newProducto=r,l.enableNewProducto=!0}),o._UZ(5,"ion-icon",23),o.qZA(),o.TgZ(6,"ion-button",8),o.NdJ("click",function(){const r=o.CHM(e).$implicit;return o.oxw().deleteProducto(r)}),o._UZ(7,"ion-icon",24),o.qZA()()()}if(2&n){const e=a.$implicit;o.xp6(2),o.hij(" ",e.nombre,"")}}const w=[{path:"",component:(()=>{class n{constructor(e,i,t,r,l,p,f,U){this.firestoreSvc=e,this.loadingController=i,this.toastController=t,this.alertController=r,this.firestorageSvc=l,this.pagesInfoSvc=p,this.interactionSvc=f,this.authSvc=U,this.productos=[],this.supermercados=[],this.secciones=[],this.enableNewProducto=!1,this.path="Productos/",this.newImage="",this.localId=null,this.infoIUser=null}ngOnInit(){this.authSvc.stateUser().subscribe(i=>{this.getLocalId()}),this.getProductos();const e=this.pagesInfoSvc.getProducto();void 0!==e&&(this.newProducto=e),this.getProductos(),this.getSupermercados(),this.getSecciones()}getSupermercados(){this.firestoreSvc.getCollection("Supermercados").subscribe(i=>{this.supermercados=i})}getSecciones(){this.firestoreSvc.getCollection("Seccion").subscribe(i=>{this.secciones=i})}getLocalId(){return(0,d.mG)(this,void 0,void 0,function*(){const e=yield this.authSvc.getLocalId();e?(this.localId=e,console.log(this.localId),this.getInfoUser()):console.log("No existe localId")})}getInfoUser(){this.firestoreSvc.getDocument("Usuarios",this.localId).subscribe(t=>{t&&(this.infoIUser=t),console.log("los datos son ->",t)})}guardarProducto(){return(0,d.mG)(this,void 0,void 0,function*(){this.interactionSvc.presentLoading();const i=this.newProducto.nombre;if(void 0!==this.newFile){const t=yield this.firestorageSvc.uploadImage(this.newFile,"Productos/",i);this.newProducto.foto=t}this.firestoreSvc.createDocument(this.newProducto,this.path,this.newProducto.id).then(t=>(0,d.mG)(this,void 0,void 0,function*(){this.interactionSvc.presentToast("guardado con exito",2e3),this.interactionSvc.loading.dismiss(),this.newImage=""})).catch(t=>{this.interactionSvc.presentToast("no se pudo guardar",2e3)})})}getProductos(){this.firestoreSvc.getCollection(this.path).subscribe(e=>{this.productos=e})}finishLoading(){return(0,d.mG)(this,void 0,void 0,function*(){this.loading=!1,yield this.loadingController.dismiss()})}deleteProducto(e){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"normal",header:"Advertencia",message:" Seguro desea <strong>eliminar</strong> este producto",buttons:[{text:"cancelar",role:"cancel",cssClass:"normal",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"Ok",handler:()=>{console.log("Confirm Okay"),this.interactionSvc.presentLoading(),this.firestoreSvc.deleteDoc(this.path,e.id).then(t=>{this.interactionSvc.presentToast("eliminado con exito",2e3),this.finishLoading(),this.interactionSvc.loading.dismiss();const r=this.path+e.nombre,l=(0,h.cF)(),p=(0,h.iH)(l,r);(0,h.oq)(p).then(()=>{}).catch(f=>{})}).catch(t=>{this.interactionSvc.presentToast("no se pudo eliminar",2e3)})}}]})).present()})}nuevo(){this.enableNewProducto=!0,this.newProducto={id:this.firestoreSvc.createId(),nombre:"",precio:null,presentacion:"",foto:"",supermercado:null,seccion:null},this.newImage=""}newImageUpload(e){return(0,d.mG)(this,void 0,void 0,function*(){if(e.target.files&&e.target.files[0]){this.newFile=e.target.files[0];const i=new FileReader;i.onload=t=>{this.newImage=t.target.result},i.readAsDataURL(e.target.files[0])}})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(P.C),o.Y36(s.HT),o.Y36(s.yF),o.Y36(s.Br),o.Y36(v.X),o.Y36(S.A),o.Y36(Z.k),o.Y36(x.e))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-set-productos"]],decls:15,vars:2,consts:[["color","secondary"],["slot","start"],[2,"text-align","end","margin","10px"],["ngDefaultControl","","color","dark",1,"normal",3,"click"],[4,"ngIf"],[1,"subtitulo","encabezado"],[4,"ngFor","ngForOf"],["slot","end"],[3,"click"],["slot","icon-only","name","close"],["color","primary","slot","icon-only","name","save-sharp"],["position","floating",1,"normal"],["type","text","inputmode","text",1,"normal",3,"ngModel","ngModelChange"],["type","number",1,"normal",3,"ngModel","ngModelChange"],["interface","popover","placeholder","Escoge uno",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["interface","popover","placeholder","Escoge una",3,"ngModel","ngModelChange"],[1,"normal"],["for","file-upload"],["slot","icon-only","name","images"],["id","file-upload","type","file","accept","image/*",2,"display","none",3,"change"],[1,"image",3,"src"],[3,"value"],["slot","icon-only","name","create-sharp"],["slot","icon-only","color","danger","name","trash-bin"]],template:function(e,i){1&e&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button"),o._UZ(4,"ion-menu-button"),o.qZA()(),o.TgZ(5,"ion-title"),o._uU(6,"Productos"),o.qZA()()(),o.TgZ(7,"ion-content")(8,"div",2)(9,"ion-button",3),o.NdJ("click",function(){return i.nuevo()}),o._uU(10," nuevo"),o.qZA()(),o.YNc(11,T,45,9,"div",4),o.TgZ(12,"h3",5),o._uU(13,"Lista de Productos"),o.qZA(),o.YNc(14,M,8,1,"ion-item",6),o.qZA()),2&e&&(o.xp6(11),o.Q6J("ngIf",i.enableNewProducto),o.xp6(3),o.Q6J("ngForOf",i.productos))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.fG,s.wd,s.W2,u.Fj,g.O5,s.PM,s.Ie,s.gu,s.Q$,s.pK,s.j9,u.JJ,u.On,s.as,s.t9,s.QI,g.sg,s.n0],styles:[".image[_ngcontent-%COMP%]{padding:10px;border:2px solid whitesmoke;width:100%;border-radius:20px;margin:auto}"]}),n})()}];let A=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[[_.Bz.forChild(w)],_.Bz]}),n})(),I=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[[g.ez,u.u5,s.Pc,A]]}),n})()}}]);